---
- name: Infrahub action plugin
  gather_facts: no
  hosts: localhost

  tasks:
    - name: SET FACTS TO SEND TO GRAPHQL ENDPOINT
      set_fact:
        graph_variables:
          $location_name: jfk1
        query_string: |
          query ($location_name: String!) {
            BuiltinLocation (name: $location_name) {
              edges {
                node {
                  name {
                    value
                  }
                }
              }
            }
          }
  
    - name: Action Plugin
      opsmill.infrahub.query_graphql:
        query: "{{ query_string}}"
        update_hostvars: yes